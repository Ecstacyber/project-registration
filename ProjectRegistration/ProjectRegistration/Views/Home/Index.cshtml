@{
    ViewData["Title"] = "Trang chủ";
}

<div class="text-center">
    <div class="col-md-3 col-sm-3  tile">
        <span>Tổng số đồ án đã được đăng ký</span>
        <h2>@ViewData["ProjectRegisteredNumber"]</h2>
    </div>
    <div class="col-md-3 col-sm-3  tile">
        <span>Tổng số đồ án đang được thực hiện</span>
        <h2>@ViewData["ProjectOnGoingNumber"]</h2>
    </div>
    <div class="col-md-3 col-sm-3  tile">
        <span>Tổng số đồ án đã hoàn thành</span>
        <h2>@ViewData["ProjectFinishedNumber"]</h2>
    </div>
    <div class="col-md-4 col-sm-6">
        <div class="x_panel tile fixed_height_320">
            <div class="x_title">
                <h2>Tỉ lệ hoàn thành đồ án</h2>
                <ul class="nav navbar-right panel_toolbox">
                    <li>
                        <a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-wrench"></i></a>
                    </li>
                    <li>
                        <a class="close-link"><i class="fa fa-close"></i></a>
                    </li>
                </ul>
                <div class="clearfix"></div>
            </div>
            <div class="x_content">
                <table class="" style="width:100%">
                    <tr>
                        <th>Học kì @ViewBag.CurrentSemester <br />
                            Năm học @ViewBag.CurrentYear
                        </th>
                        <th>
                            <div class="col-lg-8 col-md-8 col-sm-8 ">
                                <p class="">Trạng thái</p>
                            </div>
                            <div class="col-lg-4 col-md-4 col-sm-4 ">
                                <p class="">Tỉ lệ</p>
                            </div>
                        </th>
                    </tr>
                    <tr>
                        <td style="width:fit-content">
                            <canvas id="myChart" style="max-height:150px; max-width:150px" width="100" height="100"></canvas>
                        </td>
                        <td>
                            <table class="tile_info">
                                <tr>
                                    <td>
                                        <p><i class="fa fa-square blue"></i>Hoàn thành </p>
                                    </td>
                                    <td  style="vertical-align:central"  id="completedPercent"></td>
                                </tr>
                                <tr>
                                    <td >
                                        <p><i class="fa fa-square green"></i>Đang tiến hành </p>
                                    </td>
                                    <td id="doingPercent"></td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
</div>
@section Scripts{
    <script src="~/vendors/chart.js/dist/chart.js"></script>
    <script src="~/vendors/morris.js/morris.min.js"></script>
    <script src="~/vendors/raphael/raphael.min.js"></script>
    <script src="~/vendors/jquery-sparkline/dist/jquery.sparkline.min.js"></script>
    <script src="~/vendors/gauge.js/dist/gauge.min.js"></script>
    <script src="~/vendors/bootstrap-progressbar/bootstrap-progressbar.min.js"></script>
    <script src="~/vendors/skycons/skycons.js"></script>
    <script src="~/vendors/datejs/build/date.js"></script>

    <script>
        var ctx = document.getElementById("myChart");
        $.ajax({
            type: "GET",
            url: "/Home/GetProjectCompleteData",
            dataType: "json",
            success: function (data) {
                document.getElementById('completedPercent').innerHTML = (data * 100).toFixed(2) + '%';
                document.getElementById('doingPercent').innerHTML = (100 - data * 100).toFixed(2) + '%';
                var myChart = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: ["Đang tiến hành", "Đã hoàn thành"],
                        datasets: [{
                            data: [(data * 100).toFixed(2), (100 - data * 100).toFixed(2)],
                            backgroundColor: [
                                '#1ABB9C',
                                '#3498DB',
                            ],
                        }]
                    },
                    options: {
                        responsive: true,
                        legend: {
                            display: false
                        },
                    },

                });
            }
        })
        
    </script>
}